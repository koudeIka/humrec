<?php
//======================================================================//
//== About sub_label.class.php
//==--------------------------------------------------------------------//
//== This file is generated by mysql.class.php of puppets library.
//== Copyright (c) 2009-2010 - Erwan LE LOSTEC
//== Licensed under the GPL version 2.0 license.
//== See LICENSE file or
//== http://www.gnu.org/licenses/old-licenses/gpl-2.0.html
//==--------------------------------------------------------------------//
//== Contributor : Erwan LE LOSTEC
//======================================================================//
class sub_label
{/** @class sub_label
  * @brief sub_label table management.
  * Provides different methods for read and write in a sub_label table.
  **/
	public $sublab_id;
	public $sublab_name;
	public $sublab_description_fr;
	public $sublab_description_en;

	private $mysql;

	public function __construct($sublab_id = null)
	{/** @function sub_label()
	  * Create a new sub_label object.
	  * 
	  * @param	sublab_id		<int(11)>	the id of sub_label to load
	  * 
	  * @return	<boolean>
	  **/
		global $mysql;

		$this->mysql	= $mysql;

		$this->sublab_id	= $this->mysql->secure($sublab_id);
		$this->sublab_name	= null;
		$this->sublab_description_fr	= null;
		$this->sublab_description_en	= null;
		if($sublab_id != null)
		{
			$RqSub_label = $this->mysql->query("SELECT * FROM sub_label WHERE sublab_id=".$this->mysql->secure($sublab_id).";");
			if($RqSub_label->numRows() > 0)
			{
				while($objSub_label = $RqSub_label->fetchRow())
				{
					$this->sublab_id	= $this->mysql->secure($sublab_id);
					$this->sublab_name	= $objSub_label->sublab_name;
					$this->sublab_description_fr	= $objSub_label->sublab_description_fr;
					$this->sublab_description_en	= $objSub_label->sublab_description_en;
				}
			}
			else { throw new Exception("Error while loading sub_label, there no sub_label of id : $sublab_id."); return false; };
		}
		return true;
	}
	public function save()
	{/** @function save()
	 * Insert or update a sub_label.
	 *
	 * @return	<mixed>		return false or the id of inserted/updated sub_label.
	 **/
		$flag_error = false;

		$this->mysql->beginTransactions();

		if(empty($this->sublab_id))
		{//-- Insert
			if(!$this->mysql->query("INSERT INTO sub_label (sublab_name, sublab_description_fr, sublab_description_en)
									VALUES ('".$this->mysql->secure($this->sublab_name)."', '".$this->mysql->secure($this->sublab_description_fr)."', '".$this->mysql->secure($this->sublab_description_en)."');")) { $flag_error = true; };
			$this->sublab_id = $this->mysql->lastInsertId();
		}
		else
		{//-- Update
			if(!$this->mysql->query("UPDATE sub_label SET sublab_name='".$this->mysql->secure($this->sublab_name)."', sublab_description_fr='".$this->mysql->secure($this->sublab_description_fr)."', sublab_description_en='".$this->mysql->secure($this->sublab_description_en)."'
									WHERE sublab_id=".$this->mysql->secure($this->sublab_id).";")) { $flag_error = true; };
		}

		$this->mysql->endTransactions($flag_error);

		if($err_flag) 	{ throw new Exception("Error while inserting/updating the sub_label."); return false; }
		else 			{ return $this->sublab_id; };
	}
	public static function delete($sublab_id)
	{/** @function delete()
	 * Delete the sub_label.
	 *
	 * @param	sublab_id	<int(11)>	the id of the sub_label to delete
	 *
	 * @return	<boolean>
	 **/
		global $mysql;

		$flag_error = false;

		$mysql->beginTransactions();

		if(!$mysql->query("DELETE FROM sub_label WHERE sublab_id=".$mysql->secure($sublab_id).";")) { $flag_error = true; };

		$mysql->endTransactions($flag_error);

		if($err_flag) 	{ throw new Exception("Error while deleting the sub_label."); return false; }
		else 			{ return true; };
	}
}
?>